{"ast":null,"code":"import _regeneratorRuntime from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';// import user1 from 'admin-lte/dist/img/user1-128x128.jpg'\n// import user8 from 'admin-lte/dist/img/user8-128x128.jpg'\n// import user3 from 'admin-lte/dist/img/user3-128x128.jpg'\nimport axios from'axios';import{Link}from\"react-router-dom\";import{NotificationContainer,NotificationManager}from'react-notifications';import'react-notifications/lib/notifications.css';import{SessionContext}from\"../Context/Session\";import createHistory from'history/createBrowserHistory';// import user2 from 'admin-lte/dist/img/user2-160x160.jpg'\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Header=/*#__PURE__*/function(_Component){_inherits(Header,_Component);var _super=_createSuper(Header);function Header(props){var _this;_classCallCheck(this,Header);_this=_super.call(this,props);_this.logout=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var userInfo,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();userInfo=JSON.parse(localStorage.getItem('user-info'));console.log(userInfo.user);axios.interceptors.request.use(function(config){config.headers.authorization=\"Bearer \".concat(userInfo.user.token);return config;},function(error){return Promise.reject(error);});_context.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/logout\"));case 6:response=_context.sent;if(response.data.status==='sign_out'){localStorage.removeItem('user-info');_this.context.setSession(response.status,'');window.location.href='/';}else{NotificationManager.error('The operation failed.','Error',5000);}case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.history=createHistory();_this.state={notifications:0,messages:0};return _this;}// componentDidMount = () => {\n//     setInterval(async () => {\n//         let userInfo = JSON.parse(localStorage.getItem('user-info'))\n//         axios.interceptors.request.use(\n//             config => {\n//                 config.headers.authorization = `Bearer ${userInfo.user.token}`;\n//                 return config;\n//             },\n//             error => {\n//                 return Promise.reject(error)\n//             }\n//         )\n//         let messages = await axios.get(`${process.env.REACT_APP_API_URL}/managers/messages`)\n//         let notifications = await axios.get(`${process.env.REACT_APP_API_URL}/notifications`)\n//         if (messages.data.status === 'success') {\n//                 this.setState({ messages: messages.data.count })\n//         }\n//         if (notifications.data.status === 'success') {\n//             this.setState({ notifications: notifications.data.count })\n//         }\n//     }, 5000);\n// }\n_createClass(Header,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NotificationContainer,{}),/*#__PURE__*/_jsxs(\"nav\",{className:\"main-header navbar navbar-expand navbar-white navbar-light\",children:[/*#__PURE__*/_jsx(\"ul\",{className:\"navbar-nav\",children:/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(\"a\",{className:\"nav-link\",\"data-widget\":\"pushmenu\",href:'void(0)',children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-bars\"})})})}),/*#__PURE__*/_jsxs(\"ul\",{className:\"navbar-nav ml-auto\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item dropdown\",children:/*#__PURE__*/_jsxs(Link,{className:\"nav-link\",to:\"Messages\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-comments\"}),/*#__PURE__*/_jsx(\"span\",{className:\"badge badge-danger navbar-badge\",children:this.state.messages})]})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item dropdown\",children:/*#__PURE__*/_jsxs(Link,{className:\"nav-link\",to:\"Notifications\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-bell\"}),/*#__PURE__*/_jsx(\"span\",{className:\"badge badge-warning navbar-badge\",children:this.state.notifications})]})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(\"span\",{className:\"nav-link\",onClick:function onClick(e){return _this2.logout(e);},style:{cursor:'pointer'},children:\"Sign out\"})})]})]})]});}}]);return Header;}(Component);Header.contextType=SessionContext;export{Header as default};","map":{"version":3,"sources":["C:/wamp64/www/INOVA/newsystem/manager/src/Components/Header.js"],"names":["React","Component","axios","Link","NotificationContainer","NotificationManager","SessionContext","createHistory","Header","props","logout","e","preventDefault","userInfo","JSON","parse","localStorage","getItem","console","log","user","interceptors","request","use","config","headers","authorization","token","error","Promise","reject","post","process","env","REACT_APP_API_URL","response","data","status","removeItem","context","setSession","window","location","href","history","state","notifications","messages","cursor","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n// import user1 from 'admin-lte/dist/img/user1-128x128.jpg'\r\n// import user8 from 'admin-lte/dist/img/user8-128x128.jpg'\r\n// import user3 from 'admin-lte/dist/img/user3-128x128.jpg'\r\nimport axios from 'axios';\r\nimport { Link } from \"react-router-dom\";\r\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\r\nimport 'react-notifications/lib/notifications.css';\r\nimport { SessionContext } from \"../Context/Session\";\r\nimport createHistory from 'history/createBrowserHistory'\r\n// import user2 from 'admin-lte/dist/img/user2-160x160.jpg'\r\n\r\n\r\nexport default class Header extends Component {\r\n    static contextType = SessionContext;\r\n    constructor(props) {\r\n        super(props)\r\n        this.history = createHistory()\r\n        this.state = { notifications: 0, messages: 0 };\r\n    }\r\n\r\n    // componentDidMount = () => {\r\n    //     setInterval(async () => {\r\n    //         let userInfo = JSON.parse(localStorage.getItem('user-info'))\r\n    //         axios.interceptors.request.use(\r\n    //             config => {\r\n    //                 config.headers.authorization = `Bearer ${userInfo.user.token}`;\r\n    //                 return config;\r\n    //             },\r\n    //             error => {\r\n    //                 return Promise.reject(error)\r\n    //             }\r\n    //         )\r\n    \r\n    //         let messages = await axios.get(`${process.env.REACT_APP_API_URL}/managers/messages`)\r\n    //         let notifications = await axios.get(`${process.env.REACT_APP_API_URL}/notifications`)\r\n    //         if (messages.data.status === 'success') {\r\n    //                 this.setState({ messages: messages.data.count })\r\n    //         }\r\n    //         if (notifications.data.status === 'success') {\r\n    //             this.setState({ notifications: notifications.data.count })\r\n    //         }\r\n    //     }, 5000);\r\n    // }\r\n\r\n    \r\n\r\n    logout = async (e) => {\r\n        e.preventDefault()\r\n\r\n        let userInfo = JSON.parse(localStorage.getItem('user-info'))\r\n        console.log(userInfo.user)\r\n        axios.interceptors.request.use(\r\n            config => {\r\n                config.headers.authorization = `Bearer ${userInfo.user.token}`;\r\n                return config;\r\n            },\r\n            error => {\r\n                return Promise.reject(error)\r\n            }\r\n        )\r\n\r\n        let response = await axios.post(`${process.env.REACT_APP_API_URL}/logout`)\r\n        if (response.data.status === 'sign_out') {\r\n            localStorage.removeItem('user-info')\r\n            this.context.setSession(response.status, '')\r\n            window.location.href = '/'\r\n        }\r\n        else {\r\n            NotificationManager.error('The operation failed.', 'Error', 5000);\r\n        }\r\n\r\n    }\r\n    render() {\r\n        return (\r\n            <>\r\n                <NotificationContainer />\r\n                <nav className=\"main-header navbar navbar-expand navbar-white navbar-light\">\r\n                    <ul className=\"navbar-nav\">\r\n                        <li className=\"nav-item\">\r\n                            <a className=\"nav-link\" data-widget=\"pushmenu\" href={'void(0)'}><i className=\"fas fa-bars\"></i></a>\r\n                        </li>\r\n                    </ul>\r\n\r\n                    <ul className=\"navbar-nav ml-auto\">\r\n                        <li className=\"nav-item dropdown\">\r\n                            <Link className=\"nav-link\" to=\"Messages\">\r\n                                <i className=\"far fa-comments\"></i>\r\n                                <span className=\"badge badge-danger navbar-badge\">{this.state.messages}</span>\r\n                            </Link>\r\n                        </li>\r\n                        <li className=\"nav-item dropdown\">\r\n                            <Link className=\"nav-link\" to=\"Notifications\">\r\n                                <i className=\"far fa-bell\"></i>\r\n                                <span className=\"badge badge-warning navbar-badge\">{this.state.notifications}</span>\r\n                            </Link>\r\n                        </li>\r\n                        <li className=\"nav-item\">\r\n                            <span className=\"nav-link\" onClick={(e) => this.logout(e)} style={{ cursor: 'pointer' }}>\r\n                                Sign out\r\n                            </span>\r\n                        </li>\r\n                        {/* <li>\r\n                            <li class=\"nav-item\">\r\n                                <a class=\"nav-link\" data-widget=\"control-sidebar\" data-slide=\"true\" href=\"#\" role=\"button\"><i\r\n                                    class=\"fas fa-th-large\"></i></a>\r\n                            </li>\r\n                        </li> */}\r\n                    </ul>\r\n\r\n                </nav>\r\n            </>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}