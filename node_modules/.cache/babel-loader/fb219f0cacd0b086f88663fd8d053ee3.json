{"ast":null,"code":"import _slicedToArray from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/wamp64/www/INOVA/newsystem/manager/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import axios from'axios';import{NotificationContainer,NotificationManager}from'react-notifications';import'react-notifications/lib/notifications.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AddPayment=/*#__PURE__*/function(_Component){_inherits(AddPayment,_Component);var _super=_createSuper(AddPayment);function AddPayment(props){var _this;_classCallCheck(this,AddPayment);_this=_super.call(this,props);_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userInfo,payer_res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:userInfo=JSON.parse(localStorage.getItem('user-info'));axios.interceptors.request.use(function(config){config.headers.authorization=\"Bearer \".concat(userInfo.user.token);return config;},function(error){return Promise.reject(error);});if(_this.props.edit>0){_this.getLesson(_this.props.data.payer);}_context.next=5;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/managers/students\"));case 5:payer_res=_context.sent;console.log(payer_res.data);if(payer_res.data.status==='success'){_this.setState({payer:payer_res.data.students});}data=_this.props.data;_this.setState({data:data});case 10:case\"end\":return _context.stop();}}},_callee);}));_this.click=function(e){if(e.target.classList.contains('hide-modal')){_this.props.removeComponent();}};_this.handleFormData=function(event){var value=event.target.value;var name=event.target.name;var newData=_this.state.data;newData[name]=value;if(name==='payer'){if(value>0){_this.getLesson(value);}else{_this.setState({lessons:[]});}}_this.setState({data:newData});};_this.getLesson=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/managers/student/lessons/\").concat(value));case 2:response=_context2.sent;if(response.data.status==='success'){console.log(response.data);_this.setState({lessons:response.data.lessons});}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.sendForm=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var data,userInfo,response,message,_i,_Object$entries,_Object$entries$_i,key,value;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();data=_this.state.data;userInfo=JSON.parse(localStorage.getItem('user-info'));axios.interceptors.request.use(function(config){config.headers.authorization=\"Bearer \".concat(userInfo.user.token);return config;},function(error){return Promise.reject(error);});response=\"\";if(!(_this.props.edit===0)){_context3.next=11;break;}_context3.next=8;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/managers/payments\"),data);case 8:response=_context3.sent;_context3.next=14;break;case 11:_context3.next=13;return axios.put(\"\".concat(process.env.REACT_APP_API_URL,\"/managers/payments/\").concat(_this.props.edit),data);case 13:response=_context3.sent;case 14:console.log(response.data);if(response.data.status==='success'){NotificationManager.success(response.data.message,'Success',5000);_this.props.load();}if(response.data.status==='error'){message=response.data.message;for(_i=0,_Object$entries=Object.entries(message);_i<_Object$entries.length;_i++){_Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];NotificationManager.error(value,'Error',5000);}}case 17:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref3.apply(this,arguments);};}();_this.state={offices:[],payer:[],lessons:[]};return _this;}_createClass(AddPayment,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NotificationContainer,{}),/*#__PURE__*/_jsx(\"div\",{class:\"modal fade bd-example-modal-lg hide-modal\",id:\"exampleModal\",onClick:this.click,tabindex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{class:\"modal-dialog modal-lg hide-modal\",role:\"document\",children:/*#__PURE__*/_jsx(\"form\",{onSubmit:this.sendForm,children:/*#__PURE__*/_jsxs(\"div\",{class:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"modal-header\",children:[/*#__PURE__*/_jsxs(\"h5\",{class:\"modal-title\",id:\"exampleModalLabel\",children:[this.props.edit?'Edit':'Add new',\" payment details\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"close hide-modal\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{className:\"hide-modal\",\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row form-group \",children:[/*#__PURE__*/_jsx(\"label\",{className:\"col-sm-4 col-form-label\",children:\"Payer:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8\",children:/*#__PURE__*/_jsxs(\"select\",{className:\"form-control w-100\",name:\"payer\",onChange:this.handleFormData,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Student --\"}),this.state.payer.map(function(value,index){if(_this2.props.data.payer===value.id){return/*#__PURE__*/_jsxs(\"option\",{selected:true,value:value.id,children:[value.first_name,\" \",value.last_name]},index);}else{return/*#__PURE__*/_jsxs(\"option\",{value:value.id,children:[value.first_name,\" \",value.last_name]},index);}})]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row form-group \",children:[/*#__PURE__*/_jsx(\"label\",{className:\"col-sm-4 col-form-label text-sm-center\",children:\"Lesson:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8\",children:/*#__PURE__*/_jsxs(\"select\",{className:\"form-control w-100\",name:\"lesson\",onChange:this.handleFormData,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Lesson --\"}),this.state.lessons.map(function(value,index){if(_this2.props.data.lesson===value.lesson){return/*#__PURE__*/_jsx(\"option\",{selected:true,value:value.lesson,children:value.lesson_name},index);}else{return/*#__PURE__*/_jsx(\"option\",{value:value.lesson,children:value.lesson_name},index);}})]})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row form-group \",children:[/*#__PURE__*/_jsx(\"label\",{className:\"col-sm-4 col-form-label\",children:\"Adding date:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8\",children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"form-control\",name:\"payment_date\",value:this.props.data.payment_date,onChange:this.handleFormData})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row form-group \",children:[/*#__PURE__*/_jsx(\"label\",{className:\"col-sm-4 col-form-label text-sm-center\",children:\"Payment value:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8\",children:/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"text\",name:\"payment_value\",value:this.props.data.payment_value,onChange:this.handleFormData})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row form-group \",children:[/*#__PURE__*/_jsx(\"label\",{className:\"col-sm-2 col-form-label\",children:\"Comment:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-10\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",name:\"note\",value:this.props.data.note,onChange:this.handleFormData})})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"reset\",class:\"btn btn-default hide-modal\",\"data-dismiss\":\"modal\",children:\"Close\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",class:\"btn btn-success\",children:\"Save\"})]})]})})})})]});}}]);return AddPayment;}(Component);export{AddPayment as default};","map":{"version":3,"sources":["C:/wamp64/www/INOVA/newsystem/manager/src/Components/Finance/Modals/AddPayment.js"],"names":["React","Component","axios","NotificationContainer","NotificationManager","AddPayment","props","componentDidMount","userInfo","JSON","parse","localStorage","getItem","interceptors","request","use","config","headers","authorization","user","token","error","Promise","reject","edit","getLesson","data","payer","get","process","env","REACT_APP_API_URL","payer_res","console","log","status","setState","students","click","e","target","classList","contains","removeComponent","handleFormData","event","value","name","newData","state","lessons","post","response","sendForm","preventDefault","put","success","message","load","Object","entries","key","offices","map","index","id","first_name","last_name","lesson","lesson_name","payment_date","payment_value","note"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport axios from 'axios';\r\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\r\nimport 'react-notifications/lib/notifications.css';\r\n\r\nexport default class AddPayment extends Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            offices: [],\r\n            payer: [],\r\n            lessons: [],\r\n        }\r\n    }\r\n\r\n    componentDidMount = async () => {\r\n        let userInfo = JSON.parse(localStorage.getItem('user-info'))\r\n        axios.interceptors.request.use(\r\n            config => {\r\n                config.headers.authorization = `Bearer ${userInfo.user.token}`;\r\n                return config;\r\n            },\r\n            error => {\r\n                return Promise.reject(error)\r\n            }\r\n        )\r\n        if (this.props.edit > 0) {\r\n            this.getLesson(this.props.data.payer)\r\n        }\r\n        \r\n        let payer_res = await axios.get(`${process.env.REACT_APP_API_URL}/managers/students`)\r\n        console.log(payer_res.data)\r\n        if (payer_res.data.status === 'success') {\r\n            this.setState({\r\n                payer: payer_res.data.students\r\n            })\r\n        }\r\n\r\n        let data = this.props.data\r\n        this.setState({ data: data })\r\n    }\r\n    click = (e) => {\r\n        if (e.target.classList.contains('hide-modal')) {\r\n            this.props.removeComponent()\r\n        }\r\n    }\r\n    handleFormData = event => {\r\n        let value = event.target.value\r\n        let name = event.target.name\r\n\r\n        let newData = this.state.data;\r\n        newData[name] = value\r\n\r\n        if (name === 'payer') {\r\n            if (value > 0) {\r\n                this.getLesson(value)\r\n            }\r\n            else {\r\n                this.setState({\r\n                    lessons: []\r\n                })\r\n            }\r\n        }\r\n\r\n        this.setState({ data: newData })\r\n    }\r\n    getLesson = async value => {\r\n        let response = await axios.post(`${process.env.REACT_APP_API_URL}/managers/student/lessons/${value}`)\r\n        if (response.data.status === 'success') {\r\n            console.log(response.data)\r\n            this.setState({\r\n                lessons: response.data.lessons\r\n            })\r\n        }\r\n    }\r\n\r\n    sendForm = async (event) => {\r\n        event.preventDefault()\r\n\r\n        let data = this.state.data\r\n        let userInfo = JSON.parse(localStorage.getItem('user-info'))\r\n        axios.interceptors.request.use(\r\n            config => {\r\n                config.headers.authorization = `Bearer ${userInfo.user.token}`;\r\n                return config;\r\n            },\r\n            error => {\r\n                return Promise.reject(error)\r\n            }\r\n        )\r\n        let response = \"\"\r\n        if (this.props.edit === 0) {\r\n            response = await axios.post(`${process.env.REACT_APP_API_URL}/managers/payments`, data)\r\n        }\r\n        else {\r\n            response = await axios.put(`${process.env.REACT_APP_API_URL}/managers/payments/${this.props.edit}`, data)\r\n        }\r\n        console.log(response.data)\r\n        if (response.data.status === 'success') {\r\n            NotificationManager.success(response.data.message, 'Success', 5000);\r\n            this.props.load()\r\n        }\r\n        if (response.data.status === 'error') {\r\n            let message = response.data.message;\r\n            for (const [key, value] of Object.entries(message)) {\r\n                NotificationManager.error(value, 'Error', 5000);\r\n            }\r\n        }\r\n\r\n    }\r\n    render() {\r\n        return (\r\n            <>\r\n                <NotificationContainer />\r\n                <div class=\"modal fade bd-example-modal-lg hide-modal\" id=\"exampleModal\" onClick={this.click} tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n                    <div class=\"modal-dialog modal-lg hide-modal\" role=\"document\">\r\n                        <form onSubmit={this.sendForm}>\r\n                            <div class=\"modal-content\">\r\n                                <div class=\"modal-header\">\r\n                                    <h5 class=\"modal-title\" id=\"exampleModalLabel\">{(this.props.edit) ? 'Edit' : 'Add new'} payment details</h5>\r\n                                    <button type=\"button\" class=\"close hide-modal\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n                                        <span className=\"hide-modal\" aria-hidden=\"true\">&times;</span>\r\n                                    </button>\r\n                                </div>\r\n                                <div class=\"modal-body\">\r\n\r\n\r\n                                    <div class=\"row\">\r\n                                        <div className=\"col-sm-6\">\r\n                                            <div className=\"row form-group \">\r\n                                                <label className=\"col-sm-4 col-form-label\">\r\n                                                    Payer:\r\n                                            </label>\r\n                                                <div className=\"col-sm-8\">\r\n                                                    <select className=\"form-control w-100\" name=\"payer\" onChange={this.handleFormData}>\r\n                                                        <option value=\"\">-- Student --</option>\r\n                                                        {\r\n                                                            this.state.payer.map((value, index) => {\r\n                                                                if (this.props.data.payer === value.id) {\r\n                                                                    return <option key={index} selected value={value.id}>{value.first_name} {value.last_name}</option>\r\n                                                                }\r\n                                                                else {\r\n                                                                    return <option key={index} value={value.id}>{value.first_name} {value.last_name}</option>\r\n                                                                }\r\n                                                            })\r\n                                                        }\r\n                                                    </select>\r\n                                                </div>\r\n\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"col-sm-6\">\r\n                                            <div className=\"row form-group \">\r\n                                                <label className=\"col-sm-4 col-form-label text-sm-center\">\r\n                                                    Lesson:\r\n                                            </label>\r\n                                                <div className=\"col-sm-8\">\r\n                                                    <select className=\"form-control w-100\" name=\"lesson\" onChange={this.handleFormData}>\r\n                                                        <option value=\"\">-- Lesson --</option>\r\n                                                        {\r\n                                                            this.state.lessons.map((value, index) => {\r\n                                                                if (this.props.data.lesson === value.lesson) {\r\n                                                                    return <option key={index} selected value={value.lesson}>{value.lesson_name}</option>\r\n                                                                }\r\n                                                                else {\r\n                                                                    return <option key={index} value={value.lesson}>{value.lesson_name}</option>\r\n                                                                }\r\n                                                            })\r\n                                                        }\r\n                                                    </select>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                    </div>\r\n                                    <div class=\"row\">\r\n                                        <div className=\"col-sm-6\">\r\n                                            <div className=\"row form-group \">\r\n                                                <label className=\"col-sm-4 col-form-label\">\r\n                                                    Adding date:\r\n                                            </label>\r\n                                                <div className=\"col-sm-8\">\r\n                                                    <input type=\"date\" className=\"form-control\" name=\"payment_date\" value={this.props.data.payment_date} onChange={this.handleFormData} />\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"col-sm-6\">\r\n                                            <div className=\"row form-group \">\r\n                                                <label className=\"col-sm-4 col-form-label text-sm-center\">\r\n                                                    Payment value:\r\n                                            </label>\r\n                                                <div className=\"col-sm-8\">\r\n                                                    <input className=\"form-control\" type=\"text\" name=\"payment_value\" value={this.props.data.payment_value} onChange={this.handleFormData} />\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"row form-group \">\r\n                                        <label className=\"col-sm-2 col-form-label\">\r\n                                            Comment:\r\n                                    </label>\r\n                                        <div className=\"col-sm-10\">\r\n                                            <textarea className=\"form-control\" name=\"note\" value={this.props.data.note} onChange={this.handleFormData}></textarea>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                </div>\r\n                                <div class=\"modal-footer\">\r\n                                    <button type=\"reset\" class=\"btn btn-default hide-modal\" data-dismiss=\"modal\">Close</button>\r\n                                    <button type=\"submit\" class=\"btn btn-success\">Save</button>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}